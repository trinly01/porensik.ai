(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ed864002"],{"6a40":function(e,t,s){"use strict";var r=s("6a8e"),i=s.n(r);i.a},"6a8e":function(e,t,s){},c613:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"q-pa-md ",attrs:{id:"t-main-body"},nativeOn:{click:function(t){e.$root.clickedItem=e.$root.currentFolder}}},[s("div",{staticClass:"text-caption q-pb-md"},[e._v("Folders")]),s("div",{staticClass:"row items-start q-gutter-md q-pb-md q-pr-md"},e._l(e.folders,function(t){return s("q-card",{directives:[{name:"show",rawName:"v-show",value:!t.trash,expression:"!folder.trash"}],key:t._id,staticClass:"my-card col-xs-12 col-sm-6 col-md-4 no-shadow",style:{"background-color":e.$root.clickedItem._id===t._id?"#E1F5FE":"white"},attrs:{bordered:""},nativeOn:{dblclick:function(s){return e.dblclick(t)},click:function(s){e.$timeout(function(){e.$root.clickedItem=t},10)}}},[s("q-card-section",{staticClass:"row items-center no-wrap",staticStyle:{"max-height":"56px"}},[s("div",{staticClass:"col text-weight-regular limited-text",class:{"text-primary":e.$root.clickedItem._id===t._id,"text-blue-grey-14":e.$root.clickedItem._id!==t._id}},[s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{round:"",flat:"",color:"blue-grey-14",size:"sm",icon:"folder"}}),e._v("\n            "+e._s(t.label)+"\n            "),t.label.length>25?s("q-tooltip",[e._v("\n              "+e._s(t.label)+"\n            ")]):e._e()],1),s("div",{staticClass:"col-auto"},[s("q-btn",{attrs:{color:"grey-7",size:"sm",round:"",flat:"",icon:"more_vert"}},[s("node-menu",{attrs:{node:t}})],1)],1)])],1)}),1),s("div",{staticClass:"row text-caption q-mt-md"},[e._v("Files")]),s("div",{staticClass:"row items-start q-gutter-md q-pb-md q-pr-md"},e._l(e.files,function(t){return s("q-card",{directives:[{name:"show",rawName:"v-show",value:!t.trash,expression:"!file.trash"}],key:t._id,staticClass:"my-card col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2 no-shadow",style:{"background-color":e.$root.clickedItem._id===t._id?"#E1F5FE":"white"},attrs:{bordered:""},on:{dblclick:function(s){e.$refs["node-menu-"+t._id][0].open(t)}},nativeOn:{click:function(s){e.$timeout(function(){e.$root.clickedItem=t},10)}}},[t.versions&&e.$lodash.isImage(e.currentVersion(t).fileName)?s("div",{staticClass:"thumbnail row justify-center bg-blue-grey-1"},[s("img",{key:t._id,staticClass:"portrait",attrs:{src:e.$dbCon.io.io.uri+"/uploads?_id="+t._id+(!0!==t.security.public?"&t="+e.$root.jwt:""),alt:"Image"}})]):t.versions&&e.$lodash.isVideo(e.currentVersion(t).fileName)?s("div",{staticClass:"thumbnail"},[s("video",{staticClass:"thumbnail",attrs:{controls:"",preload:"none"}},[s("source",{attrs:{src:e.$dbCon.io.io.uri+"/uploads?_id="+t._id+(!0!==t.security.public?"&t="+e.$root.jwt:"")}}),e._v("\n          Your browser does not support the "),s("code",[e._v("video")]),e._v(" tag.\n        ")])]):t.versions&&e.$lodash.isAudio(e.currentVersion(t).fileName)?s("div",{staticClass:"thumbnail bg-blue-grey-1"},[s("audio",{staticClass:"q-pa-md",staticStyle:{position:"absolute",width:"100%",top:"32px"},attrs:{controls:"",preload:"none"}},[s("source",{attrs:{src:e.$dbCon.io.io.uri+"/uploads?_id="+e.currentVersion(t)._id}}),e._v("\n          Your browser does not support the "),s("code",[e._v("audio")]),e._v(" tag.\n        ")])]):s("div",{staticClass:"row justify-center bg-blue-grey-1"},[t.type&&"doc"===t.type?s("q-icon",{staticClass:"q-pt-md q-pb-md thumbnail",attrs:{name:"fas fa-file-alt",size:"64px",color:"blue-grey-3"}}):t.type&&"form"===t.type?s("q-icon",{staticClass:"q-pt-md q-pb-md thumbnail",attrs:{name:"fas fa-file-signature",size:"64px",color:"blue-grey-3"}}):s("q-icon",{staticClass:"q-pt-md q-pb-md thumbnail",attrs:{name:"fas fa-file",size:"64px",color:"blue-grey-3"}})],1),s("q-card-section",{staticClass:"row items-center no-wrap",staticStyle:{"max-height":"56px"}},[s("div",{staticClass:"col text-weight-regular limited-text",class:{"text-primary":e.$root.clickedItem._id===t._id,"text-blue-grey-14":e.$root.clickedItem._id!==t._id}},[t.type&&"doc"===t.type?s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{icon:"fas fa-file-alt",round:"",flat:"",color:"blue",size:"sm"}}):t.type&&"form"===t.type?s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{icon:"fas fa-file-signature",round:"",flat:"",color:"purple",size:"sm"}}):t.versions&&e.$lodash.isImage(e.currentVersion(t).fileName)?s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{icon:"photo_size_select_actual",round:"",flat:"",color:"red",size:"sm"}}):t.versions&&e.$lodash.isVideo(e.currentVersion(t).fileName)?s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{icon:"videocam",round:"",flat:"",color:"red",size:"sm"}}):t.versions&&e.$lodash.isAudio(e.currentVersion(t).fileName)?s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{icon:"volume_up",round:"",flat:"",color:"red",size:"sm"}}):s("q-btn",{staticClass:"bg-white q-mr-sm",attrs:{icon:"fas fa-file",round:"",flat:"",color:"blue",size:"sm"}}),e._v("\n          "+e._s(t.label)+"\n          "),t.label.length>25?s("q-tooltip",[e._v("\n            "+e._s(t.label)+"\n          ")]):e._e()],1),s("div",{staticClass:"col-auto"},[s("q-btn",{attrs:{color:"grey-7",size:"sm",round:"",flat:"",icon:"more_vert"}},[s("node-menu",{ref:"node-menu-"+t._id,refInFor:!0,attrs:{node:t}})],1)],1)])],1)}),1)])},i=[],o=(s("20d6"),s("967e")),n=s.n(o),a=(s("96cf"),s("fa84")),l=s.n(a),c=s("444c"),d={name:"PageIndex",components:{nodeMenu:c["a"]},data:function(){return{folderListner:null,listKey:Date.now(),foldersSrvc:null,filesSrvc:null,onAuth:null,folders:[],files:[]}},beforeDestroy:function(){this.foldersSrvc.destroy(),this.filesSrvc.destroy(),this.$dbCon.removeListener("authenticated",this.onAuth)},mounted:function(){var e=this;this.foldersSrvc=this.$dbCon.wingsService("juan-folders").on("dataChange",function(t){e.folders=t,console.log("folders",t)}),this.filesSrvc=this.$dbCon.wingsService("juan-files").on("dataChange",function(t){e.files=t}),this.onAuth=function(){var t=l()(n.a.mark(function t(s){return n.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:delete s.user.training_programs,delete s.user.voluntary_work,delete s.user.work_experience,delete s.user.civil_service_eligibility,delete s.user.educational_background,delete s.user.family_background,delete s.user.other_information,delete s.user.extra_information.signature,e.$root.user=s.user,console.log("LOGGED IN"),e.getFoldersAndFiles();case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),console.log("this.onAuth",this.onAuth),this.$root.user&&this.getFoldersAndFiles(),this.$dbCon.on("authenticated",this.onAuth)},methods:{currentVersion:function(e){var t=null;return t="undefined"===typeof e.versions[0].approved?0:e.versions[0].approved?0:1,e.versions[t].fileName=e.versions[t].fileName||"",e.versions[t]},dblclick:function(){var e=l()(n.a.mark(function e(t){return n.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$router.push("/myDrive/"+t._id),e.next=3,this.$dbCon.services["juan-folders"].reQuery({query:{parentFolder:t._id,trash:{$ne:!0}}});case 3:this.$root.currentFolder=t,this.$root.clickedItem=t;case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),checkSecurity:function(e){var t=this,s=function(e){return e.value._id===t.$root.user._id};return e.public||this.$lodash.findIndex(e.viewers,s)>-1||this.$lodash.findIndex(e.uploaders,s)>-1||this.$lodash.findIndex(e.modifiers,s)>-1||this.$lodash.findIndex(e.removers,s)>-1||this.$lodash.findIndex(e.folderCreators,s)>-1||this.$lodash.findIndex(e.approvers,s)>-1},getFoldersAndFiles:function(){var e=this,t={"value._id":this.$root.user._id},s={query:{$or:[{"security.viewers":{$elemMatch:t}},{"security.uploaders":{$elemMatch:t}},{"security.modifiers":{$elemMatch:t}},{"security.removers":{$elemMatch:t}},{"security.folderCreators":{$elemMatch:t}},{"security.approvers":{$elemMatch:t}}]}},r={channels:[{value:function(t,s){return console.log("checkSecurity",e.checkSecurity(t),s.parentFolder===e.$route.params._id),e.checkSecurity(t)},prop:"security"}]};this.foldersSrvc.reset(s,r),this.filesSrvc.reset(s,r)}}},u=d,m=(s("6a40"),s("2877")),f=Object(m["a"])(u,r,i,!1,null,null,null);t["default"]=f.exports}}]);